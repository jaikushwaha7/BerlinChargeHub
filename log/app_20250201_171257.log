2025-02-01 17:12:57,344 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:12:58,184 - INFO - Starting execution of the main function.
2025-02-01 17:12:58,199 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:12:58,468 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:12:58,469 - INFO - Starting preprop_lstat function.
2025-02-01 17:12:58,493 - INFO - Renamed columns in DataFrame.
2025-02-01 17:12:58,515 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:12:58,518 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:12:58,521 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:12:58,528 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:12:58,532 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:12:58,610 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:12:58,611 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:12:58,616 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:12:58,616 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:12:58,631 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:12:58,636 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 17:12:58,644 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:12:58,644 - INFO - Starting preprop_resid function.
2025-02-01 17:12:58,646 - INFO - Renamed columns in DataFrame.
2025-02-01 17:12:58,654 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:12:58,655 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:12:58,657 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:12:58,660 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:12:58,665 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:12:58,677 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:12:58,677 - INFO - preprop_resid function completed successfully.
2025-02-01 17:12:58,677 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:12:58,708 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:12:58,724 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:12:58,732 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:12:58,736 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:12:58,736 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:12:58,736 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:05,715 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:05,718 - INFO - Starting execution of the main function.
2025-02-01 17:13:05,725 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:05,967 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:05,968 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:05,979 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:06,002 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:06,004 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:06,007 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:06,010 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:06,013 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:06,084 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:06,085 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:06,093 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:06,093 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:06,099 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:06,102 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:06,110 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:06,110 - INFO - Starting preprop_resid function.
2025-02-01 17:13:06,110 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:06,117 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:06,117 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:06,119 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:06,121 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:06,123 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:06,130 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:06,131 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:06,131 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:06,144 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:06,144 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:06,148 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:06,151 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:06,151 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:06,151 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:06,188 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:06,189 - INFO - Starting execution of the main function.
2025-02-01 17:13:06,195 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:06,392 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:06,392 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:06,404 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:06,428 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:06,432 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:06,435 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:06,437 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:06,440 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:06,513 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:06,514 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:06,519 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:06,520 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:06,526 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:06,529 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:06,536 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:06,536 - INFO - Starting preprop_resid function.
2025-02-01 17:13:06,537 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:06,543 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:06,543 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:06,545 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:06,547 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:06,549 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:06,560 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:06,560 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:06,560 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:06,573 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:06,574 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:06,579 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:06,583 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:06,583 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:06,583 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:06,591 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207918DB620>), kwargs: {}
2025-02-01 17:13:06,630 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C6187850>, <folium.folium.Map object at 0x00000207918DB620>)
2025-02-01 17:13:06,776 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:06,784 - INFO -  ====> Duration 0.59 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:09,324 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:09,324 - INFO - Starting execution of the main function.
2025-02-01 17:13:09,333 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:09,529 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:09,529 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:09,545 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:09,564 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:09,567 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:09,569 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:09,571 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:09,574 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:09,646 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:09,646 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:09,653 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:09,653 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:09,659 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:09,662 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:09,669 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:09,669 - INFO - Starting preprop_resid function.
2025-02-01 17:13:09,670 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:09,679 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:09,679 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:09,681 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:09,683 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:09,685 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:09,693 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:09,693 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:09,693 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:09,706 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:09,707 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:09,710 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:09,713 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:09,714 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:09,714 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:09,894 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:09,902 - INFO -  ====> Duration 0.58 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:11,755 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:11,755 - INFO - Starting execution of the main function.
2025-02-01 17:13:11,762 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:11,967 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:11,967 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:11,979 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:11,999 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:12,002 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:12,005 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:12,007 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:12,012 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:12,088 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:12,088 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:12,094 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:12,094 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:12,100 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:12,103 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:12,110 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:12,110 - INFO - Starting preprop_resid function.
2025-02-01 17:13:12,111 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:12,118 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:12,118 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:12,120 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:12,121 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:12,125 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:12,132 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:12,133 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:12,133 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:12,147 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:12,149 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:12,152 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:12,155 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:12,155 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:12,156 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:12,335 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:12,346 - INFO -  ====> Duration 0.59 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:13,703 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:13,704 - INFO - Starting execution of the main function.
2025-02-01 17:13:13,718 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:14,130 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:14,130 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:14,150 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:14,189 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:14,193 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:14,197 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:14,199 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:14,205 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:14,336 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:14,336 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:14,348 - INFO -  ====> Duration 0.22 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:14,348 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:14,357 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:14,361 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:14,371 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:14,372 - INFO - Starting preprop_resid function.
2025-02-01 17:13:14,373 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:14,384 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:14,385 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:14,388 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:14,390 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:14,394 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:14,404 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:14,405 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:14,405 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:14,426 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:14,428 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:14,433 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:14,440 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:14,440 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:14,441 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:14,472 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:14,482 - INFO -  ====> Duration 0.78 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:27,651 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:27,653 - INFO - Starting execution of the main function.
2025-02-01 17:13:27,662 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:27,874 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:27,875 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:27,886 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:27,916 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:27,919 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:27,922 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:27,925 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:27,928 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:28,035 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:28,035 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:28,044 - INFO -  ====> Duration 0.17 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:28,044 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:28,050 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:28,054 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:28,062 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:28,062 - INFO - Starting preprop_resid function.
2025-02-01 17:13:28,063 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:28,074 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:28,075 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:28,077 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:28,079 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:28,082 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:28,090 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:28,090 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:28,090 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:28,107 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:28,108 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:28,112 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:28,115 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:28,115 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:28,116 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:28,142 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:28,153 - INFO -  ====> Duration 0.50 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:41,919 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:41,920 - INFO - Starting execution of the main function.
2025-02-01 17:13:41,934 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:42,189 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:42,190 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:42,205 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:42,226 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:42,229 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:42,232 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:42,233 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:42,237 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:42,309 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:42,309 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:42,315 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:42,315 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:42,320 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:42,323 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:13:42,330 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:42,330 - INFO - Starting preprop_resid function.
2025-02-01 17:13:42,331 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:42,338 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:42,339 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:42,341 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:42,342 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:42,344 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:42,352 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:42,352 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:42,353 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:42,366 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:42,367 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:42,370 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:42,374 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:42,374 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:42,374 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:42,390 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:42,397 - INFO -  ====> Duration 0.48 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:13:43,134 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:13:43,137 - INFO - Starting execution of the main function.
2025-02-01 17:13:43,148 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:13:43,464 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:13:43,464 - INFO - Starting preprop_lstat function.
2025-02-01 17:13:43,489 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:43,527 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:43,531 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:13:43,536 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:43,539 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:13:43,546 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:13:43,682 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:43,683 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:13:43,698 - INFO -  ====> Duration 0.23 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:13:43,698 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:13:43,719 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:13:43,728 - INFO -  ====> Duration 0.03 secs: Counts loading stations per PLZ
2025-02-01 17:13:43,740 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:13:43,744 - INFO - Starting preprop_resid function.
2025-02-01 17:13:43,747 - INFO - Renamed columns in DataFrame.
2025-02-01 17:13:43,764 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:13:43,765 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:13:43,771 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:13:43,774 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:13:43,779 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:13:43,790 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:13:43,790 - INFO - preprop_resid function completed successfully.
2025-02-01 17:13:43,791 - INFO -  ====> Duration 0.05 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:13:43,822 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:13:43,824 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:13:43,831 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:13:43,838 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:13:43,838 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:13:43,839 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:13:43,842 - INFO - Searching for postal code: 10115
2025-02-01 17:13:43,850 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:13:43,856 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
2025-02-01 17:13:43,858 - INFO - result shape: ([ChargingStation(postal_code=10115, latitude=52.53195, longitude=13.3838)], StationSearchPerformed(timestamp=Timestamp('2025-02-01 17:13:43.856990'), postal_code='10115', stations_found=0))

2025-02-01 17:13:43,888 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:13:43,902 - INFO -  ====> Duration 0.76 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:18:19,040 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:18:19,093 - INFO - Starting execution of the main function.
2025-02-01 17:18:19,138 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:18:19,388 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:18:19,388 - INFO - Starting preprop_lstat function.
2025-02-01 17:18:19,424 - INFO - Renamed columns in DataFrame.
2025-02-01 17:18:19,451 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:18:19,456 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:18:19,458 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:18:19,466 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:18:19,470 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:18:19,547 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:18:19,547 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:18:19,554 - INFO -  ====> Duration 0.17 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:18:19,555 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:18:19,571 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:18:19,575 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 17:18:19,582 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:18:19,582 - INFO - Starting preprop_resid function.
2025-02-01 17:18:19,583 - INFO - Renamed columns in DataFrame.
2025-02-01 17:18:19,590 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:18:19,590 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:18:19,591 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:18:19,593 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:18:19,596 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:18:19,603 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:18:19,603 - INFO - preprop_resid function completed successfully.
2025-02-01 17:18:19,604 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:18:19,617 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:18:19,625 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:18:19,630 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:18:19,633 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:18:19,633 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:18:19,633 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:18:19,665 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:18:19,674 - INFO -  ====> Duration 0.58 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:25:15,851 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:15,896 - INFO - Starting execution of the main function.
2025-02-01 17:25:15,956 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:16,267 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:16,268 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:16,308 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:16,366 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:16,373 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:16,376 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:16,389 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:16,396 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:16,491 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:16,492 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:16,504 - INFO -  ====> Duration 0.24 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:16,504 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:16,525 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:16,529 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 17:25:16,538 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:16,538 - INFO - Starting preprop_resid function.
2025-02-01 17:25:16,540 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:16,549 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:16,549 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:16,551 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:16,553 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:16,555 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:16,564 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:16,564 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:16,565 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:16,581 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:16,590 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:25:16,595 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:25:16,598 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:25:16,599 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:25:16,599 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:25:16,639 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:25:16,649 - INFO -  ====> Duration 0.75 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:25:16,987 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:16,988 - INFO - Starting execution of the main function.
2025-02-01 17:25:16,995 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:17,197 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:17,197 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:17,209 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:17,238 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:17,241 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:17,244 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:17,247 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:17,251 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:17,322 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:17,323 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:17,331 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:17,331 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:17,337 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:17,340 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:25:17,347 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:17,347 - INFO - Starting preprop_resid function.
2025-02-01 17:25:17,347 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:17,354 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:17,355 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:17,357 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:17,358 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:17,361 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:17,368 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:17,368 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:17,369 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:17,382 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:17,383 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:25:17,387 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:25:17,391 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:25:17,391 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:25:17,391 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:25:17,392 - INFO - Searching for postal code: 10118
2025-02-01 17:25:17,396 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:25:17,398 - INFO - Filtered dataframe:
Empty GeoDataFrame
Columns: [PLZ, Einwohner, Breitengrad, Längengrad, geometry, Number]
Index: []
2025-02-01 17:25:17,398 - WARNING - No locations found for postal code: 10118
2025-02-01 17:25:17,399 - INFO - result shape: ([], StationSearchPerformed(timestamp=Timestamp('2025-02-01 17:25:17.398975'), postal_code='10118', stations_found=0))

2025-02-01 17:25:17,414 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:25:17,423 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:25:25,238 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:25,239 - INFO - Starting execution of the main function.
2025-02-01 17:25:25,245 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:25,445 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:25,445 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:25,458 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:25,479 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:25,482 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:25,484 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:25,486 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:25,488 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:25,563 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:25,563 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:25,572 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:25,574 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:25,580 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:25,584 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:25:25,592 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:25,592 - INFO - Starting preprop_resid function.
2025-02-01 17:25:25,592 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:25,599 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:25,600 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:25,602 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:25,603 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:25,606 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:25,613 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:25,613 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:25,613 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:25,626 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:25,627 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:25:25,631 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:25:25,635 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:25:25,638 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:25:25,638 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:25:25,656 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:25:25,664 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:25:26,761 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:26,762 - INFO - Starting execution of the main function.
2025-02-01 17:25:26,768 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:26,972 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:26,973 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:26,984 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:27,004 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:27,007 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:27,011 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:27,013 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:27,017 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:27,088 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:27,088 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:27,099 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:27,100 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:27,105 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:27,108 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:25:27,115 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:27,115 - INFO - Starting preprop_resid function.
2025-02-01 17:25:27,116 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:27,123 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:27,124 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:27,125 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:27,126 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:27,129 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:27,136 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:27,136 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:27,137 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:27,150 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:27,151 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:25:27,154 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:25:27,157 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:25:27,158 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:25:27,158 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:25:27,159 - INFO - Searching for postal code: 10115
2025-02-01 17:25:27,162 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:25:27,166 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
2025-02-01 17:25:27,167 - INFO - result shape: ([ChargingStation(postal_code=10115, latitude=52.53195, longitude=13.3838)], StationSearchPerformed(timestamp=Timestamp('2025-02-01 17:25:27.167021'), postal_code='10115', stations_found=0))

2025-02-01 17:25:27,181 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:25:27,189 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:25:39,764 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:39,764 - INFO - Starting execution of the main function.
2025-02-01 17:25:39,778 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:39,846 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:25:39,861 - INFO - Starting execution of the main function.
2025-02-01 17:25:39,877 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:25:40,064 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:40,065 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:40,079 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:40,105 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:40,109 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:40,112 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:40,115 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:40,120 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:40,192 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:40,193 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:40,202 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:40,202 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:40,210 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:40,213 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:25:40,223 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:40,232 - INFO - Starting preprop_resid function.
2025-02-01 17:25:40,235 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:40,245 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:40,252 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:40,254 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:40,257 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:40,260 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:40,270 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:40,272 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:40,273 - INFO -  ====> Duration 0.04 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:40,293 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:40,398 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:25:40,398 - INFO - Starting preprop_lstat function.
2025-02-01 17:25:40,412 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:40,445 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:40,448 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:25:40,452 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:40,454 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:25:40,457 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:25:40,532 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:40,532 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:25:40,540 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:25:40,540 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:25:40,545 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:25:40,549 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:25:40,556 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:25:40,556 - INFO - Starting preprop_resid function.
2025-02-01 17:25:40,557 - INFO - Renamed columns in DataFrame.
2025-02-01 17:25:40,564 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:25:40,565 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:25:40,566 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:25:40,568 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:25:40,570 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:25:40,579 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:25:40,579 - INFO - preprop_resid function completed successfully.
2025-02-01 17:25:40,580 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:25:40,599 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:25:40,600 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:25:40,604 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:25:40,609 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:25:40,609 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:25:40,609 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:25:40,610 - INFO - Searching for postal code: 10117
2025-02-01 17:25:40,615 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:25:40,620 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 17:25:40,620 - INFO - result shape: ([ChargingStation(postal_code=10117, latitude=52.51752, longitude=13.38777)], StationSearchPerformed(timestamp=Timestamp('2025-02-01 17:25:40.620851'), postal_code='10117', stations_found=54))

2025-02-01 17:25:40,638 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:25:40,647 - INFO -  ====> Duration 0.79 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:46:17,791 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:46:17,866 - INFO - Starting execution of the main function.
2025-02-01 17:46:17,911 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:46:18,186 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:46:18,187 - INFO - Starting preprop_lstat function.
2025-02-01 17:46:18,222 - INFO - Renamed columns in DataFrame.
2025-02-01 17:46:18,269 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:46:18,275 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:46:18,278 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:46:18,284 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:46:18,290 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:46:18,392 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:46:18,393 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:46:18,400 - INFO -  ====> Duration 0.21 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:46:18,400 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:46:18,428 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:46:18,435 - INFO -  ====> Duration 0.03 secs: Counts loading stations per PLZ
2025-02-01 17:46:18,446 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:46:18,446 - INFO - Starting preprop_resid function.
2025-02-01 17:46:18,448 - INFO - Renamed columns in DataFrame.
2025-02-01 17:46:18,459 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:46:18,459 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:46:18,462 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:46:18,464 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:46:18,468 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:46:18,478 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:46:18,478 - INFO - preprop_resid function completed successfully.
2025-02-01 17:46:18,479 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:46:18,499 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:46:18,507 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:46:18,519 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:46:18,523 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:46:18,523 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:46:18,524 - INFO -  ====> Duration 0.02 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:46:18,564 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:46:18,576 - INFO -  ====> Duration 0.71 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:46:20,127 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:46:20,128 - INFO - Starting execution of the main function.
2025-02-01 17:46:20,139 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:46:20,341 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:46:20,341 - INFO - Starting preprop_lstat function.
2025-02-01 17:46:20,354 - INFO - Renamed columns in DataFrame.
2025-02-01 17:46:20,373 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:46:20,376 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:46:20,379 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:46:20,382 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:46:20,385 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:46:20,460 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:46:20,460 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:46:20,470 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:46:20,470 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:46:20,475 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:46:20,478 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:46:20,487 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:46:20,487 - INFO - Starting preprop_resid function.
2025-02-01 17:46:20,487 - INFO - Renamed columns in DataFrame.
2025-02-01 17:46:20,493 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:46:20,494 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:46:20,495 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:46:20,496 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:46:20,500 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:46:20,507 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:46:20,507 - INFO - preprop_resid function completed successfully.
2025-02-01 17:46:20,508 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:46:20,525 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:46:20,526 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:46:20,530 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:46:20,534 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:46:20,535 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:46:20,535 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:46:20,536 - INFO - Searching for postal code: 10117
2025-02-01 17:46:20,540 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:46:20,545 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 17:46:20,546 - ERROR - An unexpected error occurred: The truth value of a GeoDataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-02-01 17:46:20,546 - INFO - result shape: []

2025-02-01 17:46:20,546 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 17:48:22,593 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:48:22,605 - INFO - Starting execution of the main function.
2025-02-01 17:48:22,611 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:48:22,811 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:48:22,812 - INFO - Starting preprop_lstat function.
2025-02-01 17:48:22,825 - INFO - Renamed columns in DataFrame.
2025-02-01 17:48:22,844 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:48:22,846 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:48:22,849 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:48:22,851 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:48:22,854 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:48:22,927 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:48:22,928 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:48:22,933 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:48:22,934 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:48:22,939 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:48:22,942 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:48:22,949 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:48:22,949 - INFO - Starting preprop_resid function.
2025-02-01 17:48:22,950 - INFO - Renamed columns in DataFrame.
2025-02-01 17:48:22,956 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:48:22,957 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:48:22,959 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:48:22,960 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:48:22,963 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:48:22,970 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:48:22,970 - INFO - preprop_resid function completed successfully.
2025-02-01 17:48:22,971 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:48:22,984 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:48:22,985 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:48:22,988 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:48:22,991 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:48:22,991 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:48:22,992 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:48:23,014 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 17:48:23,021 - INFO -  ====> Duration 0.42 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 17:48:25,052 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:48:25,053 - INFO - Starting execution of the main function.
2025-02-01 17:48:25,059 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:48:25,264 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:48:25,264 - INFO - Starting preprop_lstat function.
2025-02-01 17:48:25,278 - INFO - Renamed columns in DataFrame.
2025-02-01 17:48:25,298 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:48:25,301 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:48:25,303 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:48:25,305 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:48:25,308 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:48:25,375 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:48:25,375 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:48:25,382 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:48:25,382 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:48:25,388 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:48:25,390 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 17:48:25,402 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:48:25,403 - INFO - Starting preprop_resid function.
2025-02-01 17:48:25,406 - INFO - Renamed columns in DataFrame.
2025-02-01 17:48:25,412 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:48:25,413 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:48:25,415 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:48:25,416 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:48:25,419 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:48:25,425 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:48:25,425 - INFO - preprop_resid function completed successfully.
2025-02-01 17:48:25,426 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:48:25,437 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:48:25,438 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:48:25,441 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:48:25,448 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:48:25,448 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:48:25,448 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:48:25,449 - INFO - search_by_postal_code method called.
2025-02-01 17:48:25,449 - INFO - Starting postal code validation.
2025-02-01 17:48:25,449 - INFO - Finished postal code validation.
2025-02-01 17:48:25,449 - INFO - Searching for postal code: 10117
2025-02-01 17:48:25,453 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:48:25,454 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 17:48:25,454 - INFO - Finished filtering the dataframe.
2025-02-01 17:48:25,457 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 17:48:25,457 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 17:48:25,457 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 17:48:25,457 - ERROR - An unexpected error occurred: The truth value of a GeoDataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-02-01 17:48:25,457 - INFO - result shape: []

2025-02-01 17:48:25,457 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 17:54:54,466 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 17:54:54,526 - INFO - Starting execution of the main function.
2025-02-01 17:54:54,589 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 17:54:54,857 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 17:54:54,857 - INFO - Starting preprop_lstat function.
2025-02-01 17:54:54,891 - INFO - Renamed columns in DataFrame.
2025-02-01 17:54:54,934 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:54:54,939 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 17:54:54,941 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:54:54,952 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 17:54:54,956 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 17:54:55,034 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:54:55,035 - INFO - preprop_lstat function completed successfully.
2025-02-01 17:54:55,042 - INFO -  ====> Duration 0.18 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 17:54:55,042 - INFO - Starting count_plz_occurrences function.
2025-02-01 17:54:55,064 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 17:54:55,072 - INFO -  ====> Duration 0.03 secs: Counts loading stations per PLZ
2025-02-01 17:54:55,082 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 17:54:55,082 - INFO - Starting preprop_resid function.
2025-02-01 17:54:55,084 - INFO - Renamed columns in DataFrame.
2025-02-01 17:54:55,091 - INFO - Formatted latitude and longitude columns.
2025-02-01 17:54:55,092 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 17:54:55,094 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 17:54:55,096 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 17:54:55,098 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 17:54:55,107 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 17:54:55,108 - INFO - preprop_resid function completed successfully.
2025-02-01 17:54:55,108 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 17:54:55,125 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 17:54:55,134 - INFO - Starting merge_geo_dataframes function.
2025-02-01 17:54:55,138 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 17:54:55,142 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 17:54:55,142 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 17:54:55,142 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 17:54:55,145 - INFO - search_by_postal_code method called.
2025-02-01 17:54:55,146 - INFO - Starting postal code validation.
2025-02-01 17:54:55,146 - INFO - Finished postal code validation.
2025-02-01 17:54:55,146 - INFO - Searching for postal code: 10117
2025-02-01 17:54:55,151 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 17:54:55,152 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 17:54:55,152 - INFO - Finished filtering the dataframe.
2025-02-01 17:54:55,156 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 17:54:55,156 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 17:54:55,156 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 17:54:55,165 - ERROR - An unexpected error occurred: 'Station Name'
2025-02-01 17:54:55,165 - INFO - result shape: []

2025-02-01 17:54:55,165 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 18:05:18,245 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:18,388 - INFO - Starting execution of the main function.
2025-02-01 18:05:18,431 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:18,684 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:18,685 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:18,717 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:18,751 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:18,756 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:18,760 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:18,766 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:18,771 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:18,851 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:18,851 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:18,859 - INFO -  ====> Duration 0.17 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:18,859 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:18,872 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:18,876 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 18:05:18,886 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:18,887 - INFO - Starting preprop_resid function.
2025-02-01 18:05:18,888 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:18,896 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:18,896 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:18,898 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:18,901 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:18,903 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:18,911 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:18,912 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:18,912 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:18,929 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:18,943 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:18,956 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:18,960 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:18,960 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:18,960 - INFO -  ====> Duration 0.02 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:18,963 - INFO - search_by_postal_code method called.
2025-02-01 18:05:18,963 - INFO - Starting postal code validation.
2025-02-01 18:05:18,963 - INFO - Finished postal code validation.
2025-02-01 18:05:18,963 - INFO - Searching for postal code: 10117
2025-02-01 18:05:18,967 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:05:18,969 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:05:18,969 - INFO - Finished filtering the dataframe.
2025-02-01 18:05:18,973 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 18:05:18,973 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 18:05:18,974 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 18:05:18,981 - ERROR - An unexpected error occurred: 'Name'
2025-02-01 18:05:18,982 - INFO - result shape: []

2025-02-01 18:05:18,982 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 18:05:22,329 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:22,330 - INFO - Starting execution of the main function.
2025-02-01 18:05:22,338 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:22,532 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:22,532 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:22,543 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:22,561 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:22,563 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:22,565 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:22,567 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:22,573 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:22,643 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:22,643 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:22,650 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:22,650 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:22,655 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:22,657 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:22,663 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:22,664 - INFO - Starting preprop_resid function.
2025-02-01 18:05:22,664 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:22,670 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:22,670 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:22,672 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:22,673 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:22,675 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:22,682 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:22,682 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:22,682 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:22,694 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:22,695 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:22,697 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:22,700 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:22,700 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:22,700 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:22,751 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:22,752 - INFO - Starting execution of the main function.
2025-02-01 18:05:22,758 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:22,952 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:22,952 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:22,964 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:22,983 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:22,986 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:22,988 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:22,989 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:22,992 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:23,060 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:23,060 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:23,067 - INFO -  ====> Duration 0.11 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:23,067 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:23,072 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:23,074 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:23,081 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:23,081 - INFO - Starting preprop_resid function.
2025-02-01 18:05:23,082 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:23,087 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:23,088 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:23,092 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:23,093 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:23,096 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:23,109 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:23,116 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:23,116 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:23,130 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:23,133 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:23,137 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:23,139 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:23,139 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:23,139 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:32,045 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:32,046 - INFO - Starting execution of the main function.
2025-02-01 18:05:32,055 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:32,337 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:32,337 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:32,354 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:32,376 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:32,379 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:32,382 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:32,384 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:32,387 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:32,463 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:32,463 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:32,472 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:32,472 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:32,478 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:32,481 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:32,489 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:32,490 - INFO - Starting preprop_resid function.
2025-02-01 18:05:32,491 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:32,497 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:32,498 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:32,500 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:32,501 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:32,503 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:32,511 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:32,511 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:32,511 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:32,524 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:32,525 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:32,529 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:32,532 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:32,532 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:32,532 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:32,596 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:32,598 - INFO - Starting execution of the main function.
2025-02-01 18:05:32,607 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:32,842 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:32,843 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:32,855 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:32,875 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:32,877 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:32,879 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:32,881 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:32,884 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:32,955 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:32,955 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:32,962 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:32,962 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:32,968 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:32,970 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:32,977 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:32,977 - INFO - Starting preprop_resid function.
2025-02-01 18:05:32,978 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:32,984 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:32,984 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:32,987 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:32,988 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:32,991 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:32,997 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:32,998 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:32,998 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:33,012 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:34,509 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:34,514 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:34,518 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:34,518 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:34,518 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:34,526 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C5AF50>), kwargs: {}
2025-02-01 18:05:34,586 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C60DDFD0>, <folium.folium.Map object at 0x00000207C3C5AF50>)
2025-02-01 18:05:34,766 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:05:34,775 - INFO -  ====> Duration 2.18 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:05:45,122 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:45,123 - INFO - Starting execution of the main function.
2025-02-01 18:05:45,133 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:45,341 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:45,341 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:45,354 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:45,374 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:45,377 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:45,379 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:45,381 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:45,385 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:45,453 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:45,454 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:45,461 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:45,461 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:45,466 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:45,469 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:45,476 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:45,476 - INFO - Starting preprop_resid function.
2025-02-01 18:05:45,477 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:45,483 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:45,483 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:45,486 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:45,487 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:45,490 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:45,497 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:45,497 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:45,497 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:45,510 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:45,511 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:45,514 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:45,517 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:45,517 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:45,517 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:45,523 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C5BD50>), kwargs: {}
2025-02-01 18:05:45,563 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C4C0AC10>, <folium.folium.Map object at 0x00000207C3C5BD50>)
2025-02-01 18:05:45,777 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:05:45,778 - INFO - Starting execution of the main function.
2025-02-01 18:05:45,784 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:05:45,996 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:05:45,997 - INFO - Starting preprop_lstat function.
2025-02-01 18:05:46,011 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:46,034 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:46,037 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:05:46,040 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:46,042 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:05:46,045 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:05:46,115 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:46,115 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:05:46,124 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:05:46,124 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:05:46,130 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:05:46,132 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:05:46,141 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:05:46,141 - INFO - Starting preprop_resid function.
2025-02-01 18:05:46,142 - INFO - Renamed columns in DataFrame.
2025-02-01 18:05:46,150 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:05:46,150 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:05:46,152 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:05:46,153 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:05:46,155 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:05:46,163 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:05:46,163 - INFO - preprop_resid function completed successfully.
2025-02-01 18:05:46,163 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:05:46,176 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:05:46,177 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:05:46,180 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:05:46,183 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:05:46,183 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:05:46,183 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:05:46,184 - INFO - search_by_postal_code method called.
2025-02-01 18:05:46,184 - INFO - Starting postal code validation.
2025-02-01 18:05:46,184 - INFO - Finished postal code validation.
2025-02-01 18:05:46,184 - INFO - Searching for postal code: 10115
2025-02-01 18:05:46,188 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:05:46,188 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:05:46,188 - INFO - Finished filtering the dataframe.
2025-02-01 18:05:46,192 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
2025-02-01 18:05:46,192 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 18:05:46,192 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 18:05:46,194 - ERROR - An unexpected error occurred: 'Name'
2025-02-01 18:05:46,194 - INFO - result shape: []

2025-02-01 18:05:46,195 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 18:14:54,937 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:14:55,023 - INFO - Starting execution of the main function.
2025-02-01 18:14:55,097 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:14:55,367 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:14:55,368 - INFO - Starting preprop_lstat function.
2025-02-01 18:14:55,417 - INFO - Renamed columns in DataFrame.
2025-02-01 18:14:55,459 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:14:55,467 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:14:55,471 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:14:55,483 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:14:55,495 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:14:55,589 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:14:55,589 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:14:55,595 - INFO -  ====> Duration 0.23 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:14:55,595 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:14:55,630 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:14:55,635 - INFO -  ====> Duration 0.04 secs: Counts loading stations per PLZ
2025-02-01 18:14:55,642 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:14:55,642 - INFO - Starting preprop_resid function.
2025-02-01 18:14:55,643 - INFO - Renamed columns in DataFrame.
2025-02-01 18:14:55,649 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:14:55,650 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:14:55,652 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:14:55,654 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:14:55,656 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:14:55,664 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:14:55,664 - INFO - preprop_resid function completed successfully.
2025-02-01 18:14:55,665 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:14:55,679 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:14:55,689 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:14:55,694 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:14:55,697 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:14:55,697 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:14:55,697 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:14:55,730 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3DF1050>), kwargs: {}
2025-02-01 18:14:55,790 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C4B08E50>, <folium.folium.Map object at 0x00000207C3DF1050>)
2025-02-01 18:14:55,957 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:14:55,965 - INFO -  ====> Duration 0.94 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:14:57,710 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:14:57,711 - INFO - Starting execution of the main function.
2025-02-01 18:14:57,720 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:14:57,918 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:14:57,918 - INFO - Starting preprop_lstat function.
2025-02-01 18:14:57,933 - INFO - Renamed columns in DataFrame.
2025-02-01 18:14:57,952 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:14:57,954 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:14:57,957 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:14:57,958 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:14:57,961 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:14:58,030 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:14:58,030 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:14:58,037 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:14:58,037 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:14:58,042 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:14:58,045 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:14:58,053 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:14:58,053 - INFO - Starting preprop_resid function.
2025-02-01 18:14:58,053 - INFO - Renamed columns in DataFrame.
2025-02-01 18:14:58,059 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:14:58,060 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:14:58,061 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:14:58,062 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:14:58,064 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:14:58,071 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:14:58,071 - INFO - preprop_resid function completed successfully.
2025-02-01 18:14:58,071 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:14:58,086 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:14:58,087 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:14:58,090 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:14:58,093 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:14:58,093 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:14:58,093 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:14:58,094 - INFO - search_by_postal_code method called.
2025-02-01 18:14:58,094 - INFO - Starting postal code validation.
2025-02-01 18:14:58,094 - INFO - Finished postal code validation.
2025-02-01 18:14:58,095 - INFO - Searching for postal code: 10115
2025-02-01 18:14:58,098 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:14:58,099 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:14:58,099 - INFO - Finished filtering the dataframe.
2025-02-01 18:14:58,102 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
2025-02-01 18:14:58,102 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 18:14:58,102 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 18:14:58,103 - ERROR - An unexpected error occurred: 'Series' object has no attribute 'iterrows'
2025-02-01 18:14:58,103 - INFO - result shape: []

2025-02-01 18:14:58,103 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 18:18:03,991 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:18:04,035 - INFO - Starting execution of the main function.
2025-02-01 18:18:04,062 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:18:04,293 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:18:04,294 - INFO - Starting preprop_lstat function.
2025-02-01 18:18:04,325 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:04,364 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:04,368 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:18:04,371 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:04,377 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:18:04,382 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:18:04,460 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:04,461 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:18:04,469 - INFO -  ====> Duration 0.18 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:18:04,469 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:18:04,484 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:18:04,489 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 18:18:04,497 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:18:04,497 - INFO - Starting preprop_resid function.
2025-02-01 18:18:04,498 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:04,505 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:04,506 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:18:04,507 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:04,509 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:18:04,512 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:18:04,519 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:04,519 - INFO - preprop_resid function completed successfully.
2025-02-01 18:18:04,520 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:18:04,536 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:18:04,540 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:18:04,545 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:18:04,548 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:18:04,548 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:18:04,548 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:18:04,561 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3DF2350>), kwargs: {}
2025-02-01 18:18:04,604 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C617A430>, <folium.folium.Map object at 0x00000207C3DF2350>)
2025-02-01 18:18:04,760 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:18:04,767 - INFO -  ====> Duration 0.73 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:18:09,665 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:18:09,665 - INFO - Starting execution of the main function.
2025-02-01 18:18:09,671 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:18:09,890 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:18:09,890 - INFO - Starting preprop_lstat function.
2025-02-01 18:18:09,904 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:09,927 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:09,930 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:18:09,933 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:09,935 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:18:09,938 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:18:10,007 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:10,007 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:18:10,013 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:18:10,014 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:18:10,019 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:18:10,022 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:18:10,028 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:18:10,028 - INFO - Starting preprop_resid function.
2025-02-01 18:18:10,029 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:10,035 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:10,036 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:18:10,038 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:10,039 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:18:10,041 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:18:10,048 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:10,048 - INFO - preprop_resid function completed successfully.
2025-02-01 18:18:10,049 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:18:10,060 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:18:10,062 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:18:10,065 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:18:10,068 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:18:10,068 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:18:10,068 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:18:10,075 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C5BE50>), kwargs: {}
2025-02-01 18:18:10,121 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C20BC050>, <folium.folium.Map object at 0x00000207C3C5BE50>)
2025-02-01 18:18:10,317 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:18:10,329 - INFO -  ====> Duration 0.66 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:18:11,618 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:18:11,619 - INFO - Starting execution of the main function.
2025-02-01 18:18:11,629 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:18:11,864 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:18:11,864 - INFO - Starting preprop_lstat function.
2025-02-01 18:18:11,877 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:11,908 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:11,911 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:18:11,913 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:11,915 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:18:11,919 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:18:12,004 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:12,005 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:18:12,014 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:18:12,014 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:18:12,019 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:18:12,021 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:18:12,029 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:18:12,029 - INFO - Starting preprop_resid function.
2025-02-01 18:18:12,030 - INFO - Renamed columns in DataFrame.
2025-02-01 18:18:12,037 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:18:12,038 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:18:12,039 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:18:12,041 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:18:12,043 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:18:12,051 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:18:12,055 - INFO - preprop_resid function completed successfully.
2025-02-01 18:18:12,055 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:18:12,070 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:18:12,072 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:18:12,075 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:18:12,079 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:18:12,080 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:18:12,080 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:18:12,084 - INFO - search_by_postal_code method called.
2025-02-01 18:18:12,084 - INFO - Starting postal code validation.
2025-02-01 18:18:12,084 - INFO - Finished postal code validation.
2025-02-01 18:18:12,085 - INFO - Searching for postal code: 10117
2025-02-01 18:18:12,088 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:18:12,090 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:18:12,091 - INFO - Finished filtering the dataframe.
2025-02-01 18:18:12,095 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 18:18:12,096 - INFO - Calling display_folium_map with filtered station data.
2025-02-01 18:18:12,096 - INFO - display_folium_map called with 1 stations to display.
2025-02-01 18:18:12,096 - ERROR - An unexpected error occurred: 'Series' object has no attribute 'iterrows'
2025-02-01 18:18:12,096 - INFO - result shape: []

2025-02-01 18:18:12,096 - ERROR - create_electric_charging_residents_heatmap raised an exception: list index out of range
2025-02-01 18:20:06,872 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:20:06,915 - INFO - Starting execution of the main function.
2025-02-01 18:20:06,948 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:20:07,665 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:20:07,665 - INFO - Starting preprop_lstat function.
2025-02-01 18:20:07,699 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:07,742 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:07,746 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:20:07,750 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:07,757 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:20:07,762 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:20:07,856 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:07,856 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:20:07,864 - INFO -  ====> Duration 0.20 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:20:07,864 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:20:07,881 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:20:07,884 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 18:20:07,892 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:20:07,892 - INFO - Starting preprop_resid function.
2025-02-01 18:20:07,893 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:07,899 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:07,899 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:20:07,901 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:07,903 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:20:07,906 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:20:07,913 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:07,913 - INFO - preprop_resid function completed successfully.
2025-02-01 18:20:07,913 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:20:07,927 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:20:07,931 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:20:07,936 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:20:07,939 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:20:07,939 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:20:07,939 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:20:07,955 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3DF1350>), kwargs: {}
2025-02-01 18:20:08,003 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C3CD74D0>, <folium.folium.Map object at 0x00000207C3DF1350>)
2025-02-01 18:20:08,160 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:20:08,168 - INFO -  ====> Duration 1.25 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:20:10,640 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:20:10,641 - INFO - Starting execution of the main function.
2025-02-01 18:20:10,647 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:20:11,044 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:20:11,044 - INFO - Starting preprop_lstat function.
2025-02-01 18:20:11,065 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:11,088 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:11,091 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:20:11,095 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:11,096 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:20:11,101 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:20:11,187 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:11,188 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:20:11,199 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:20:11,199 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:20:11,205 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:20:11,208 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:20:11,218 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:20:11,218 - INFO - Starting preprop_resid function.
2025-02-01 18:20:11,219 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:11,227 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:11,228 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:20:11,231 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:11,233 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:20:11,237 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:20:11,247 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:11,247 - INFO - preprop_resid function completed successfully.
2025-02-01 18:20:11,248 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:20:11,269 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:20:11,271 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:20:11,276 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:20:11,282 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:20:11,282 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:20:11,282 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:20:11,283 - INFO - search_by_postal_code method called.
2025-02-01 18:20:11,283 - INFO - Starting postal code validation.
2025-02-01 18:20:11,284 - INFO - Finished postal code validation.
2025-02-01 18:20:11,284 - INFO - Searching for postal code: 10117
2025-02-01 18:20:11,290 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:20:11,292 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:20:11,293 - INFO - Finished filtering the dataframe.
2025-02-01 18:20:11,298 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 18:20:11,298 - INFO - Converting filtered station data to ChargingStation objects.
2025-02-01 18:20:11,300 - INFO - result shape: ([ChargingStation(postal_code=10117, latitude=52.51752, longitude=13.38777)], StationSearchPerformed(timestamp=Timestamp('2025-02-01 18:20:11.299330'), postal_code='10117', stations_found=54))

2025-02-01 18:20:11,308 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C5BE50>), kwargs: {}
2025-02-01 18:20:11,363 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C3CD58D0>, <folium.folium.Map object at 0x00000207C3C5BE50>)
2025-02-01 18:20:11,539 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:20:11,549 - INFO -  ====> Duration 0.91 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:20:19,034 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:20:19,035 - INFO - Starting execution of the main function.
2025-02-01 18:20:19,045 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:20:19,273 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:20:19,274 - INFO - Starting preprop_lstat function.
2025-02-01 18:20:19,287 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:19,311 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:19,314 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:20:19,316 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:19,319 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:20:19,322 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:20:19,395 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:19,396 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:20:19,402 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:20:19,403 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:20:19,410 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:20:19,413 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:20:19,420 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:20:19,420 - INFO - Starting preprop_resid function.
2025-02-01 18:20:19,421 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:19,428 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:19,429 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:20:19,431 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:19,432 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:20:19,434 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:20:19,442 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:19,442 - INFO - preprop_resid function completed successfully.
2025-02-01 18:20:19,442 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:20:19,454 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:20:19,456 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:20:19,459 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:20:19,461 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:20:19,462 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:20:19,462 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:20:19,646 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:20:19,665 - INFO -  ====> Duration 0.63 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:20:20,776 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:20:20,777 - INFO - Starting execution of the main function.
2025-02-01 18:20:20,784 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:20:21,062 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:20:21,063 - INFO - Starting preprop_lstat function.
2025-02-01 18:20:21,082 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:21,112 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:21,117 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:20:21,121 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:21,124 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:20:21,129 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:20:21,255 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:21,255 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:20:21,269 - INFO -  ====> Duration 0.21 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:20:21,269 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:20:21,280 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:20:21,285 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 18:20:21,297 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:20:21,297 - INFO - Starting preprop_resid function.
2025-02-01 18:20:21,299 - INFO - Renamed columns in DataFrame.
2025-02-01 18:20:21,316 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:20:21,317 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:20:21,322 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:20:21,324 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:20:21,329 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:20:21,343 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:20:21,343 - INFO - preprop_resid function completed successfully.
2025-02-01 18:20:21,344 - INFO -  ====> Duration 0.05 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:20:21,373 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:20:21,375 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:20:21,382 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:20:21,389 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:20:21,390 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:20:21,390 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:20:21,450 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:20:21,471 - INFO -  ====> Duration 0.69 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:32:36,483 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:32:36,560 - INFO - Starting execution of the main function.
2025-02-01 18:32:36,636 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:32:36,943 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:32:36,943 - INFO - Starting preprop_lstat function.
2025-02-01 18:32:36,993 - INFO - Renamed columns in DataFrame.
2025-02-01 18:32:37,039 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:32:37,046 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:32:37,049 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:32:37,062 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:32:37,069 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:32:37,178 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:32:37,179 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:32:37,190 - INFO -  ====> Duration 0.25 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:32:37,190 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:32:37,209 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:32:37,215 - INFO -  ====> Duration 0.03 secs: Counts loading stations per PLZ
2025-02-01 18:32:37,226 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:32:37,226 - INFO - Starting preprop_resid function.
2025-02-01 18:32:37,227 - INFO - Renamed columns in DataFrame.
2025-02-01 18:32:37,239 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:32:37,240 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:32:37,242 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:32:37,248 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:32:37,252 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:32:37,263 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:32:37,263 - INFO - preprop_resid function completed successfully.
2025-02-01 18:32:37,263 - INFO -  ====> Duration 0.04 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:32:37,284 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:32:37,295 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:32:37,300 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:32:37,304 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:32:37,304 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:32:37,304 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:32:37,323 - ERROR - create_electric_charging_residents_heatmap raised an exception: ChargeStationRating.charge_station_rating() missing 1 required positional argument: 'df_merged_stations'
2025-02-01 18:33:08,274 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:33:08,288 - INFO - Starting execution of the main function.
2025-02-01 18:33:08,294 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:33:08,502 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:33:08,502 - INFO - Starting preprop_lstat function.
2025-02-01 18:33:08,514 - INFO - Renamed columns in DataFrame.
2025-02-01 18:33:08,554 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:33:08,559 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:33:08,562 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:33:08,565 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:33:08,569 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:33:08,639 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:33:08,640 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:33:08,645 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:33:08,646 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:33:08,651 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:33:08,653 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:33:08,660 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:33:08,660 - INFO - Starting preprop_resid function.
2025-02-01 18:33:08,661 - INFO - Renamed columns in DataFrame.
2025-02-01 18:33:08,668 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:33:08,668 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:33:08,670 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:33:08,671 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:33:08,674 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:33:08,681 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:33:08,681 - INFO - preprop_resid function completed successfully.
2025-02-01 18:33:08,681 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:33:08,695 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:33:08,696 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:33:08,699 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:33:08,702 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:33:08,702 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:33:08,702 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:33:08,712 - ERROR - create_electric_charging_residents_heatmap raised an exception: unhashable type: 'Series'
2025-02-01 18:35:40,625 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:35:40,654 - INFO - Starting execution of the main function.
2025-02-01 18:35:40,673 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:35:40,949 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:35:40,949 - INFO - Starting preprop_lstat function.
2025-02-01 18:35:40,971 - INFO - Renamed columns in DataFrame.
2025-02-01 18:35:41,004 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:35:41,008 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:35:41,012 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:35:41,016 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:35:41,021 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:35:41,105 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:35:41,106 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:35:41,113 - INFO -  ====> Duration 0.16 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:35:41,113 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:35:41,121 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:35:41,124 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:35:41,132 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:35:41,132 - INFO - Starting preprop_resid function.
2025-02-01 18:35:41,132 - INFO - Renamed columns in DataFrame.
2025-02-01 18:35:41,138 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:35:41,139 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:35:41,141 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:35:41,142 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:35:41,144 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:35:41,158 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:35:41,159 - INFO - preprop_resid function completed successfully.
2025-02-01 18:35:41,159 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:35:41,183 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:35:41,187 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:35:41,191 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:35:41,194 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:35:41,194 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:35:41,194 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:35:41,218 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:35:41,228 - INFO -  ====> Duration 0.57 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:35:47,173 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:35:47,176 - INFO - Starting execution of the main function.
2025-02-01 18:35:47,186 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:35:47,394 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:35:47,395 - INFO - Starting preprop_lstat function.
2025-02-01 18:35:47,408 - INFO - Renamed columns in DataFrame.
2025-02-01 18:35:47,432 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:35:47,435 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:35:47,438 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:35:47,440 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:35:47,448 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:35:47,519 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:35:47,520 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:35:47,531 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:35:47,531 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:35:47,537 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:35:47,540 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:35:47,550 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:35:47,550 - INFO - Starting preprop_resid function.
2025-02-01 18:35:47,552 - INFO - Renamed columns in DataFrame.
2025-02-01 18:35:47,558 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:35:47,558 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:35:47,561 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:35:47,562 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:35:47,565 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:35:47,573 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:35:47,573 - INFO - preprop_resid function completed successfully.
2025-02-01 18:35:47,573 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:35:47,586 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:35:47,588 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:35:47,592 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:35:47,595 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:35:47,595 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:35:47,595 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:35:47,597 - INFO - search_by_postal_code method called.
2025-02-01 18:35:47,597 - INFO - Starting postal code validation.
2025-02-01 18:35:47,597 - INFO - Finished postal code validation.
2025-02-01 18:35:47,597 - INFO - Searching for postal code: 10117
2025-02-01 18:35:47,602 - INFO - merged_df: 
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
0  10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...     0.0
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2  10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...     6.0
3  10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...    30.0
4  10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...    37.0
2025-02-01 18:35:47,603 - INFO - Filtering the dataframe based on the provided postal code.
2025-02-01 18:35:47,604 - INFO - Finished filtering the dataframe.
2025-02-01 18:35:47,607 - INFO - Filtered dataframe:
     PLZ  Einwohner Breitengrad Längengrad                                           geometry  Number
1  10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...    54.0
2025-02-01 18:35:47,607 - INFO - Converting filtered station data to ChargingStation objects.
2025-02-01 18:35:47,609 - INFO - result shape: ([ChargingStation(postal_code=10117, latitude=52.51752, longitude=13.38777)], StationSearchPerformed(timestamp=Timestamp('2025-02-01 18:35:47.608443'), postal_code='10117', stations_found=54))

2025-02-01 18:35:47,623 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:35:47,632 - INFO -  ====> Duration 0.46 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:36:19,941 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:36:19,942 - INFO - Starting execution of the main function.
2025-02-01 18:36:19,948 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:36:20,151 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:36:20,151 - INFO - Starting preprop_lstat function.
2025-02-01 18:36:20,166 - INFO - Renamed columns in DataFrame.
2025-02-01 18:36:20,187 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:36:20,190 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:36:20,192 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:36:20,194 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:36:20,197 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:36:20,266 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:36:20,266 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:36:20,273 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:36:20,273 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:36:20,279 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:36:20,281 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:36:20,288 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:36:20,288 - INFO - Starting preprop_resid function.
2025-02-01 18:36:20,289 - INFO - Renamed columns in DataFrame.
2025-02-01 18:36:20,295 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:36:20,296 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:36:20,298 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:36:20,300 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:36:20,302 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:36:20,309 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:36:20,309 - INFO - preprop_resid function completed successfully.
2025-02-01 18:36:20,309 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:36:20,321 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:36:20,322 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:36:20,325 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:36:20,328 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:36:20,328 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:36:20,328 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:36:20,359 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:36:20,369 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:37:57,310 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:37:57,330 - INFO - Starting execution of the main function.
2025-02-01 18:37:57,339 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:37:57,559 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:37:57,559 - INFO - Starting preprop_lstat function.
2025-02-01 18:37:57,572 - INFO - Renamed columns in DataFrame.
2025-02-01 18:37:57,592 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:37:57,594 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:37:57,596 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:37:57,598 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:37:57,601 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:37:57,671 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:37:57,671 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:37:57,679 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:37:57,679 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:37:57,685 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:37:57,687 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:37:57,694 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:37:57,694 - INFO - Starting preprop_resid function.
2025-02-01 18:37:57,695 - INFO - Renamed columns in DataFrame.
2025-02-01 18:37:57,701 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:37:57,702 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:37:57,703 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:37:57,704 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:37:57,709 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:37:57,722 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:37:57,722 - INFO - preprop_resid function completed successfully.
2025-02-01 18:37:57,723 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:37:57,738 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:37:57,742 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:37:57,748 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:37:57,752 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:37:57,752 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:37:57,752 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:37:57,770 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:37:57,780 - INFO -  ====> Duration 0.45 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:40:36,968 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:40:36,980 - INFO - Starting execution of the main function.
2025-02-01 18:40:36,987 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:40:37,192 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:40:37,192 - INFO - Starting preprop_lstat function.
2025-02-01 18:40:37,207 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:37,232 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:37,235 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:40:37,238 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:37,240 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:40:37,243 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:40:37,314 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:37,314 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:40:37,322 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:40:37,322 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:40:37,328 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:40:37,331 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:40:37,339 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:40:37,339 - INFO - Starting preprop_resid function.
2025-02-01 18:40:37,340 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:37,346 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:37,346 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:40:37,348 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:37,349 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:40:37,351 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:40:37,358 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:37,359 - INFO - preprop_resid function completed successfully.
2025-02-01 18:40:37,359 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:40:37,371 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:40:37,372 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:40:37,375 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:40:37,378 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:40:37,378 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:40:37,378 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:40:37,392 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:40:37,402 - INFO -  ====> Duration 0.42 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:40:42,789 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:40:42,790 - INFO - Starting execution of the main function.
2025-02-01 18:40:42,799 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:40:43,055 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:40:43,055 - INFO - Starting preprop_lstat function.
2025-02-01 18:40:43,067 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:43,093 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:43,097 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:40:43,100 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:43,102 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:40:43,106 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:40:43,183 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:43,184 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:40:43,192 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:40:43,192 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:40:43,198 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:40:43,201 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:40:43,210 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:40:43,210 - INFO - Starting preprop_resid function.
2025-02-01 18:40:43,211 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:43,219 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:43,219 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:40:43,221 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:43,223 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:40:43,227 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:40:43,237 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:43,237 - INFO - preprop_resid function completed successfully.
2025-02-01 18:40:43,238 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:40:43,254 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:40:43,256 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:40:43,260 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:40:43,264 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:40:43,264 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:40:43,264 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:40:43,512 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:40:43,522 - INFO -  ====> Duration 0.73 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:40:45,145 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:40:45,151 - INFO - Starting execution of the main function.
2025-02-01 18:40:45,161 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:40:45,367 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:40:45,367 - INFO - Starting preprop_lstat function.
2025-02-01 18:40:45,379 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:45,401 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:45,404 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:40:45,407 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:45,409 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:40:45,412 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:40:45,485 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:45,485 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:40:45,492 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:40:45,493 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:40:45,498 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:40:45,501 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:40:45,509 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:40:45,509 - INFO - Starting preprop_resid function.
2025-02-01 18:40:45,510 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:45,517 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:45,517 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:40:45,519 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:45,520 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:40:45,523 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:40:45,531 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:45,531 - INFO - preprop_resid function completed successfully.
2025-02-01 18:40:45,532 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:40:45,545 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:40:45,546 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:40:45,550 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:40:45,553 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:40:45,553 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:40:45,553 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:40:45,567 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:40:45,580 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:40:56,775 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:40:56,783 - INFO - Starting execution of the main function.
2025-02-01 18:40:56,790 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:40:56,987 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:40:56,987 - INFO - Starting preprop_lstat function.
2025-02-01 18:40:57,002 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:57,031 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:57,034 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:40:57,038 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:57,041 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:40:57,044 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:40:57,117 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:57,118 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:40:57,125 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:40:57,125 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:40:57,131 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:40:57,134 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:40:57,142 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:40:57,142 - INFO - Starting preprop_resid function.
2025-02-01 18:40:57,143 - INFO - Renamed columns in DataFrame.
2025-02-01 18:40:57,151 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:40:57,152 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:40:57,154 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:40:57,155 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:40:57,157 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:40:57,165 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:40:57,165 - INFO - preprop_resid function completed successfully.
2025-02-01 18:40:57,165 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:40:57,178 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:40:57,180 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:40:57,183 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:40:57,186 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:40:57,186 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:40:57,186 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:40:57,198 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:40:57,207 - INFO -  ====> Duration 0.42 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:43:37,120 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:43:37,179 - INFO - Starting execution of the main function.
2025-02-01 18:43:37,248 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:43:37,576 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:43:37,576 - INFO - Starting preprop_lstat function.
2025-02-01 18:43:37,626 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:37,684 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:37,690 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:43:37,693 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:37,704 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:43:37,709 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:43:37,804 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:37,804 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:43:37,812 - INFO -  ====> Duration 0.24 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:43:37,812 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:43:37,831 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:43:37,836 - INFO -  ====> Duration 0.02 secs: Counts loading stations per PLZ
2025-02-01 18:43:37,845 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:43:37,845 - INFO - Starting preprop_resid function.
2025-02-01 18:43:37,846 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:37,852 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:37,853 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:43:37,854 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:37,856 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:43:37,858 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:43:37,865 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:37,865 - INFO - preprop_resid function completed successfully.
2025-02-01 18:43:37,866 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:43:37,880 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:43:37,888 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:43:37,893 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:43:37,897 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:43:37,897 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:43:37,897 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:43:53,231 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:43:53,232 - INFO - Starting execution of the main function.
2025-02-01 18:43:53,238 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:43:53,448 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:43:53,449 - INFO - Starting preprop_lstat function.
2025-02-01 18:43:53,462 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:53,483 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:53,486 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:43:53,489 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:53,490 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:43:53,493 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:43:53,563 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:53,563 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:43:53,569 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:43:53,570 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:43:53,575 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:43:53,577 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:43:53,585 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:43:53,585 - INFO - Starting preprop_resid function.
2025-02-01 18:43:53,586 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:53,592 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:53,592 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:43:53,593 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:53,594 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:43:53,596 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:43:53,603 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:53,603 - INFO - preprop_resid function completed successfully.
2025-02-01 18:43:53,603 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:43:53,617 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:43:53,618 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:43:53,621 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:43:53,625 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:43:53,625 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:43:53,626 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:43:53,667 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:43:53,668 - INFO - Starting execution of the main function.
2025-02-01 18:43:53,675 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:43:53,882 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:43:53,882 - INFO - Starting preprop_lstat function.
2025-02-01 18:43:53,896 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:53,915 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:53,918 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:43:53,920 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:53,921 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:43:53,924 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:43:53,995 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:53,995 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:43:54,003 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:43:54,003 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:43:54,008 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:43:54,010 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:43:54,018 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:43:54,018 - INFO - Starting preprop_resid function.
2025-02-01 18:43:54,018 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:54,024 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:54,025 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:43:54,026 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:54,027 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:43:54,029 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:43:54,036 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:54,036 - INFO - preprop_resid function completed successfully.
2025-02-01 18:43:54,036 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:43:54,049 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:43:54,050 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:43:54,052 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:43:54,055 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:43:54,055 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:43:54,055 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:43:54,061 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C58250>), kwargs: {}
2025-02-01 18:43:54,104 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C7873690>, <folium.folium.Map object at 0x00000207C3C58250>)
2025-02-01 18:43:54,245 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:43:54,254 - INFO -  ====> Duration 0.59 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:43:55,604 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:43:55,605 - INFO - Starting execution of the main function.
2025-02-01 18:43:55,611 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:43:55,822 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:43:55,822 - INFO - Starting preprop_lstat function.
2025-02-01 18:43:55,835 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:55,855 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:55,858 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:43:55,861 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:55,862 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:43:55,865 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:43:55,934 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:55,935 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:43:55,942 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:43:55,942 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:43:55,947 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:43:55,950 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:43:55,957 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:43:55,957 - INFO - Starting preprop_resid function.
2025-02-01 18:43:55,957 - INFO - Renamed columns in DataFrame.
2025-02-01 18:43:55,963 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:43:55,964 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:43:55,966 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:43:55,967 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:43:55,969 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:43:55,975 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:43:55,975 - INFO - preprop_resid function completed successfully.
2025-02-01 18:43:55,975 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:43:55,987 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:43:55,988 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:43:55,992 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:43:55,995 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:43:55,995 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:43:55,995 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:43:55,998 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:43:55,998 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207918DB230>
2025-02-01 18:43:56,004 - ERROR - create_electric_charging_residents_heatmap raised an exception: name 'log' is not defined
2025-02-01 18:44:35,208 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:44:35,227 - INFO - Starting execution of the main function.
2025-02-01 18:44:35,235 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:44:35,438 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:44:35,439 - INFO - Starting preprop_lstat function.
2025-02-01 18:44:35,451 - INFO - Renamed columns in DataFrame.
2025-02-01 18:44:35,489 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:44:35,492 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:44:35,495 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:44:35,496 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:44:35,499 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:44:35,575 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:44:35,575 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:44:35,582 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:44:35,582 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:44:35,588 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:44:35,591 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:44:35,598 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:44:35,598 - INFO - Starting preprop_resid function.
2025-02-01 18:44:35,598 - INFO - Renamed columns in DataFrame.
2025-02-01 18:44:35,605 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:44:35,606 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:44:35,608 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:44:35,610 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:44:35,615 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:44:35,623 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:44:35,624 - INFO - preprop_resid function completed successfully.
2025-02-01 18:44:35,624 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:44:35,637 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:44:35,639 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:44:35,643 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:44:35,646 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:44:35,646 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:44:35,646 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:44:35,651 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:44:35,652 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B23620>
2025-02-01 18:44:35,667 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:44:35,674 - INFO -  ====> Duration 0.45 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:44:51,902 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:44:51,903 - INFO - Starting execution of the main function.
2025-02-01 18:44:51,913 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:44:52,220 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:44:52,220 - INFO - Starting preprop_lstat function.
2025-02-01 18:44:52,236 - INFO - Renamed columns in DataFrame.
2025-02-01 18:44:52,264 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:44:52,267 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:44:52,270 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:44:52,272 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:44:52,278 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:44:52,381 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:44:52,382 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:44:52,392 - INFO -  ====> Duration 0.17 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:44:52,392 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:44:52,399 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:44:52,402 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:44:52,412 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:44:52,412 - INFO - Starting preprop_resid function.
2025-02-01 18:44:52,413 - INFO - Renamed columns in DataFrame.
2025-02-01 18:44:52,422 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:44:52,423 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:44:52,426 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:44:52,428 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:44:52,432 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:44:52,442 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:44:52,442 - INFO - preprop_resid function completed successfully.
2025-02-01 18:44:52,443 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:44:52,462 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:44:52,463 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:44:52,468 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:44:52,473 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:44:52,474 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:44:52,474 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:44:52,479 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:44:52,479 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C4C12490>
2025-02-01 18:44:52,499 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:44:52,512 - INFO -  ====> Duration 0.61 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:46:33,800 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:46:33,831 - INFO - Starting execution of the main function.
2025-02-01 18:46:33,844 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:46:34,055 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:46:34,055 - INFO - Starting preprop_lstat function.
2025-02-01 18:46:34,075 - INFO - Renamed columns in DataFrame.
2025-02-01 18:46:34,106 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:46:34,109 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:46:34,111 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:46:34,115 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:46:34,119 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:46:34,195 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:46:34,195 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:46:34,203 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:46:34,203 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:46:34,211 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:46:34,214 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:46:34,223 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:46:34,223 - INFO - Starting preprop_resid function.
2025-02-01 18:46:34,224 - INFO - Renamed columns in DataFrame.
2025-02-01 18:46:34,230 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:46:34,230 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:46:34,232 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:46:34,233 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:46:34,235 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:46:34,242 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:46:34,242 - INFO - preprop_resid function completed successfully.
2025-02-01 18:46:34,242 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:46:34,255 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:46:34,258 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:46:34,262 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:46:34,265 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:46:34,265 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:46:34,265 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:46:34,280 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:46:34,280 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207918D8EC0>
2025-02-01 18:46:34,302 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:46:34,312 - INFO -  ====> Duration 0.48 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:47:39,247 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:47:39,258 - INFO - Starting execution of the main function.
2025-02-01 18:47:39,267 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:47:39,463 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:47:39,463 - INFO - Starting preprop_lstat function.
2025-02-01 18:47:39,477 - INFO - Renamed columns in DataFrame.
2025-02-01 18:47:39,503 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:47:39,505 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:47:39,508 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:47:39,512 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:47:39,515 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:47:39,590 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:47:39,591 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:47:39,602 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:47:39,602 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:47:39,608 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:47:39,610 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:47:39,619 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:47:39,619 - INFO - Starting preprop_resid function.
2025-02-01 18:47:39,619 - INFO - Renamed columns in DataFrame.
2025-02-01 18:47:39,626 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:47:39,627 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:47:39,628 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:47:39,629 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:47:39,631 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:47:39,640 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:47:39,640 - INFO - preprop_resid function completed successfully.
2025-02-01 18:47:39,640 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:47:39,656 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:47:39,657 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:47:39,660 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:47:39,663 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:47:39,664 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:47:39,664 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:47:39,669 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:47:39,669 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B23230>
2025-02-01 18:47:39,688 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:47:39,697 - INFO -  ====> Duration 0.44 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:48:44,737 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:48:44,748 - INFO - Starting execution of the main function.
2025-02-01 18:48:44,755 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:48:44,969 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:48:44,969 - INFO - Starting preprop_lstat function.
2025-02-01 18:48:44,983 - INFO - Renamed columns in DataFrame.
2025-02-01 18:48:45,004 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:48:45,006 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:48:45,008 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:48:45,010 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:48:45,013 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:48:45,084 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:48:45,084 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:48:45,091 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:48:45,092 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:48:45,097 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:48:45,099 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:48:45,107 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:48:45,107 - INFO - Starting preprop_resid function.
2025-02-01 18:48:45,108 - INFO - Renamed columns in DataFrame.
2025-02-01 18:48:45,115 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:48:45,115 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:48:45,117 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:48:45,118 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:48:45,120 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:48:45,128 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:48:45,130 - INFO - preprop_resid function completed successfully.
2025-02-01 18:48:45,130 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:48:45,144 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:48:45,145 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:48:45,149 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:48:45,152 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:48:45,152 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:48:45,153 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:48:45,156 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:48:45,156 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B21D30>
2025-02-01 18:48:45,168 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:48:45,178 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:49:59,013 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:49:59,025 - INFO - Starting execution of the main function.
2025-02-01 18:49:59,033 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:49:59,244 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:49:59,244 - INFO - Starting preprop_lstat function.
2025-02-01 18:49:59,259 - INFO - Renamed columns in DataFrame.
2025-02-01 18:49:59,282 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:49:59,285 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:49:59,287 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:49:59,289 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:49:59,292 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:49:59,364 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:49:59,364 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:49:59,372 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:49:59,372 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:49:59,378 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:49:59,381 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:49:59,389 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:49:59,389 - INFO - Starting preprop_resid function.
2025-02-01 18:49:59,390 - INFO - Renamed columns in DataFrame.
2025-02-01 18:49:59,396 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:49:59,397 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:49:59,398 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:49:59,399 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:49:59,402 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:49:59,409 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:49:59,409 - INFO - preprop_resid function completed successfully.
2025-02-01 18:49:59,410 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:49:59,423 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:49:59,424 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:49:59,428 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:49:59,431 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:49:59,431 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:49:59,431 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:49:59,435 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:49:59,435 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B22510>
2025-02-01 18:49:59,444 - ERROR - create_electric_charging_residents_heatmap raised an exception: _LocationIndexer.__call__() takes from 1 to 2 positional arguments but 3 were given
2025-02-01 18:50:22,991 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:50:23,007 - INFO - Starting execution of the main function.
2025-02-01 18:50:23,016 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:50:23,226 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:50:23,227 - INFO - Starting preprop_lstat function.
2025-02-01 18:50:23,240 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:23,280 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:23,283 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:50:23,286 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:23,287 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:50:23,290 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:50:23,364 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:23,364 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:50:23,370 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:50:23,371 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:50:23,376 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:50:23,378 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:50:23,385 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:50:23,385 - INFO - Starting preprop_resid function.
2025-02-01 18:50:23,386 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:23,392 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:23,392 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:50:23,394 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:23,395 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:50:23,397 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:50:23,404 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:23,404 - INFO - preprop_resid function completed successfully.
2025-02-01 18:50:23,404 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:50:23,416 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:50:23,417 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:50:23,421 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:50:23,424 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:50:23,424 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:50:23,424 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:50:23,428 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:50:23,428 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B23B60>
2025-02-01 18:50:23,436 - ERROR - create_electric_charging_residents_heatmap raised an exception: unhashable type: 'Series'
2025-02-01 18:50:35,250 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:50:35,250 - INFO - Starting execution of the main function.
2025-02-01 18:50:35,256 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:50:35,489 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:50:35,490 - INFO - Starting preprop_lstat function.
2025-02-01 18:50:35,506 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:35,529 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:35,531 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:50:35,534 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:35,536 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:50:35,539 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:50:35,614 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:35,614 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:50:35,622 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:50:35,622 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:50:35,628 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:50:35,631 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:50:35,638 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:50:35,638 - INFO - Starting preprop_resid function.
2025-02-01 18:50:35,639 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:35,645 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:35,646 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:50:35,648 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:35,649 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:50:35,652 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:50:35,658 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:35,658 - INFO - preprop_resid function completed successfully.
2025-02-01 18:50:35,659 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:50:35,671 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:50:35,672 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:50:35,675 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:50:35,677 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:50:35,677 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:50:35,678 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:50:44,078 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:50:44,078 - INFO - Starting execution of the main function.
2025-02-01 18:50:44,089 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:50:44,344 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:50:44,344 - INFO - Starting preprop_lstat function.
2025-02-01 18:50:44,361 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:44,388 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:44,391 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:50:44,393 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:44,395 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:50:44,399 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:50:44,484 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:44,484 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:50:44,493 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:50:44,493 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:50:44,499 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:50:44,501 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:50:44,512 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:50:44,512 - INFO - Starting preprop_resid function.
2025-02-01 18:50:44,512 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:44,520 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:44,520 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:50:44,522 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:44,523 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:50:44,525 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:50:44,533 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:44,533 - INFO - preprop_resid function completed successfully.
2025-02-01 18:50:44,533 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:50:44,550 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:50:48,631 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:50:48,637 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:50:48,641 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:50:48,641 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:50:48,641 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:50:48,692 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:50:48,693 - INFO - Starting execution of the main function.
2025-02-01 18:50:48,700 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:50:48,955 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:50:48,955 - INFO - Starting preprop_lstat function.
2025-02-01 18:50:48,970 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:48,999 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:49,002 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:50:49,007 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:49,013 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:50:49,017 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:50:49,092 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:49,093 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:50:49,101 - INFO -  ====> Duration 0.15 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:50:49,101 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:50:49,107 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:50:49,110 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:50:49,119 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:50:49,120 - INFO - Starting preprop_resid function.
2025-02-01 18:50:49,120 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:49,127 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:49,128 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:50:49,130 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:49,131 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:50:49,133 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:50:49,141 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:49,141 - INFO - preprop_resid function completed successfully.
2025-02-01 18:50:49,141 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:50:49,155 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:50:49,390 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:50:49,395 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:50:49,399 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:50:49,399 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:50:49,400 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:50:49,412 - INFO - Called mapping_residents with args: (       PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns], <folium.folium.Map object at 0x00000207C3C59550>), kwargs: {}
2025-02-01 18:50:49,467 - INFO - mapping_residents returned (<branca.colormap.LinearColormap object at 0x00000207C7243930>, <folium.folium.Map object at 0x00000207C3C59550>)
2025-02-01 18:50:49,679 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:50:49,692 - INFO -  ====> Duration 1.00 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:50:57,569 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:50:57,572 - INFO - Starting execution of the main function.
2025-02-01 18:50:57,581 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:50:57,810 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:50:57,810 - INFO - Starting preprop_lstat function.
2025-02-01 18:50:57,825 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:57,846 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:57,849 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:50:57,851 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:57,853 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:50:57,856 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:50:57,930 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:57,930 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:50:57,938 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:50:57,938 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:50:57,944 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:50:57,947 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:50:57,956 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:50:57,957 - INFO - Starting preprop_resid function.
2025-02-01 18:50:57,957 - INFO - Renamed columns in DataFrame.
2025-02-01 18:50:57,963 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:50:57,964 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:50:57,965 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:50:57,966 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:50:57,969 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:50:57,976 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:50:57,976 - INFO - preprop_resid function completed successfully.
2025-02-01 18:50:57,976 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:50:57,988 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:50:57,989 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:50:57,993 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:50:57,996 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:50:57,996 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:50:57,996 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:50:57,999 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:50:58,000 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3CF2990>
2025-02-01 18:50:58,009 - ERROR - create_electric_charging_residents_heatmap raised an exception: unhashable type: 'Series'
2025-02-01 18:51:57,495 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:51:57,531 - INFO - Starting execution of the main function.
2025-02-01 18:51:57,553 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:51:57,802 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:51:57,802 - INFO - Starting preprop_lstat function.
2025-02-01 18:51:57,821 - INFO - Renamed columns in DataFrame.
2025-02-01 18:51:57,881 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:51:57,888 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:51:57,891 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:51:57,895 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:51:57,899 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:51:57,984 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:51:57,984 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:51:57,992 - INFO -  ====> Duration 0.19 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:51:57,992 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:51:58,025 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:51:58,030 - INFO -  ====> Duration 0.04 secs: Counts loading stations per PLZ
2025-02-01 18:51:58,038 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:51:58,039 - INFO - Starting preprop_resid function.
2025-02-01 18:51:58,040 - INFO - Renamed columns in DataFrame.
2025-02-01 18:51:58,047 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:51:58,047 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:51:58,049 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:51:58,051 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:51:58,054 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:51:58,064 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:51:58,064 - INFO - preprop_resid function completed successfully.
2025-02-01 18:51:58,065 - INFO -  ====> Duration 0.03 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:51:58,081 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:51:58,097 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:51:58,102 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:51:58,107 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:51:58,107 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:51:58,107 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:51:58,143 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:51:58,144 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207918D8C20>
2025-02-01 18:51:58,160 - ERROR - create_electric_charging_residents_heatmap raised an exception: unhashable type: 'Series'
2025-02-01 18:52:09,388 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:52:09,403 - INFO - Starting execution of the main function.
2025-02-01 18:52:09,410 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:52:09,607 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:52:09,607 - INFO - Starting preprop_lstat function.
2025-02-01 18:52:09,621 - INFO - Renamed columns in DataFrame.
2025-02-01 18:52:09,640 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:52:09,644 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:52:09,646 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:52:09,648 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:52:09,651 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:52:09,721 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:52:09,721 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:52:09,730 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:52:09,731 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:52:09,736 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:52:09,744 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:52:09,751 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:52:09,751 - INFO - Starting preprop_resid function.
2025-02-01 18:52:09,755 - INFO - Renamed columns in DataFrame.
2025-02-01 18:52:09,762 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:52:09,763 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:52:09,764 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:52:09,766 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:52:09,768 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:52:09,775 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:52:09,775 - INFO - preprop_resid function completed successfully.
2025-02-01 18:52:09,776 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:52:09,789 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:52:09,790 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:52:09,793 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:52:09,795 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:52:09,795 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:52:09,796 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:52:09,802 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:52:09,803 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C3B21BE0>
2025-02-01 18:52:09,819 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:52:09,833 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:52:49,597 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:52:49,613 - INFO - Starting execution of the main function.
2025-02-01 18:52:49,624 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:52:49,830 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:52:49,830 - INFO - Starting preprop_lstat function.
2025-02-01 18:52:49,846 - INFO - Renamed columns in DataFrame.
2025-02-01 18:52:49,867 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:52:49,870 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:52:49,873 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:52:49,875 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:52:49,878 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:52:49,957 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:52:49,958 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:52:49,965 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:52:49,965 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:52:49,971 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:52:49,974 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:52:49,982 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:52:49,982 - INFO - Starting preprop_resid function.
2025-02-01 18:52:49,983 - INFO - Renamed columns in DataFrame.
2025-02-01 18:52:49,990 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:52:49,990 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:52:49,992 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:52:49,992 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:52:49,995 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:52:50,004 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:52:50,005 - INFO - preprop_resid function completed successfully.
2025-02-01 18:52:50,005 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:52:50,017 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:52:50,019 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:52:50,022 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:52:50,025 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:52:50,025 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:52:50,025 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:52:50,030 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:52:50,030 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207918D8C20>
2025-02-01 18:52:50,045 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:52:50,054 - INFO -  ====> Duration 0.44 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:54:27,162 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:54:27,181 - INFO - Starting execution of the main function.
2025-02-01 18:54:27,190 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:54:27,401 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:54:27,401 - INFO - Starting preprop_lstat function.
2025-02-01 18:54:27,416 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:27,437 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:27,440 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:54:27,443 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:27,445 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:54:27,449 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:54:27,527 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:27,527 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:54:27,537 - INFO -  ====> Duration 0.14 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:54:27,537 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:54:27,544 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:54:27,549 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:54:27,558 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:54:27,559 - INFO - Starting preprop_resid function.
2025-02-01 18:54:27,559 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:27,565 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:27,566 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:54:27,568 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:27,568 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:54:27,570 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:54:27,578 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:27,578 - INFO - preprop_resid function completed successfully.
2025-02-01 18:54:27,579 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:54:27,590 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:54:27,592 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:54:27,596 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:54:27,599 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:54:27,599 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:54:27,599 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:54:27,604 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:54:27,605 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207918D9400>
2025-02-01 18:54:27,617 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:54:27,627 - INFO -  ====> Duration 0.45 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:54:35,241 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:54:35,242 - INFO - Starting execution of the main function.
2025-02-01 18:54:35,251 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:54:35,454 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:54:35,454 - INFO - Starting preprop_lstat function.
2025-02-01 18:54:35,469 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:35,494 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:35,497 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:54:35,500 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:35,502 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:54:35,506 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:54:35,579 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:35,580 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:54:35,587 - INFO -  ====> Duration 0.13 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:54:35,587 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:54:35,592 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:54:35,595 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:54:35,602 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:54:35,602 - INFO - Starting preprop_resid function.
2025-02-01 18:54:35,603 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:35,609 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:35,610 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:54:35,612 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:35,613 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:54:35,616 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:54:35,623 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:35,624 - INFO - preprop_resid function completed successfully.
2025-02-01 18:54:35,624 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:54:35,638 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:54:35,639 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:54:35,643 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:54:35,645 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:54:35,645 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:54:35,646 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:54:35,871 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:54:35,882 - INFO -  ====> Duration 0.64 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:54:37,145 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:54:37,146 - INFO - Starting execution of the main function.
2025-02-01 18:54:37,154 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:54:37,364 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:54:37,364 - INFO - Starting preprop_lstat function.
2025-02-01 18:54:37,376 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:37,399 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:37,402 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:54:37,405 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:37,407 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:54:37,411 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:54:37,481 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:37,482 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:54:37,488 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:54:37,488 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:54:37,493 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:54:37,496 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:54:37,504 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:54:37,505 - INFO - Starting preprop_resid function.
2025-02-01 18:54:37,505 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:37,512 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:37,512 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:54:37,515 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:37,516 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:54:37,518 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:54:37,528 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:37,528 - INFO - preprop_resid function completed successfully.
2025-02-01 18:54:37,528 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:54:37,541 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:54:37,542 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:54:37,545 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:54:37,549 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:54:37,550 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:54:37,550 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:54:37,554 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:54:37,554 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C4C13110>
2025-02-01 18:54:37,563 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:54:37,574 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
2025-02-01 18:54:58,345 - INFO - Current working directory: E:\Study\BHT\AdvancedSE\Assignment1\BerlinChargeHub
2025-02-01 18:54:58,345 - INFO - Starting execution of the main function.
2025-02-01 18:54:58,353 - INFO - geodata_berlin_plz.csv loaded successfully.
2025-02-01 18:54:58,563 - INFO - Ladesaeulenregister.csv loaded successfully.
2025-02-01 18:54:58,564 - INFO - Starting preprop_lstat function.
2025-02-01 18:54:58,576 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:58,598 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:58,601 - INFO - Filtered data for Berlin. Shape: (2746, 5)
2025-02-01 18:54:58,603 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:58,606 - INFO - Merged DataFrame with geometry. Shape: (2746, 6)
2025-02-01 18:54:58,609 - INFO - DataFrame after dropping missing geometries. Shape: (2737, 6)
2025-02-01 18:54:58,681 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:58,681 - INFO - preprop_lstat function completed successfully.
2025-02-01 18:54:58,687 - INFO -  ====> Duration 0.12 secs: Preprocessing dataframe from Ladesaeulenregister.csv
2025-02-01 18:54:58,687 - INFO - Starting count_plz_occurrences function.
2025-02-01 18:54:58,693 - INFO - count_plz_occurrences function completed successfully. Output DataFrame shape: (183, 3)
2025-02-01 18:54:58,695 - INFO -  ====> Duration 0.01 secs: Counts loading stations per PLZ
2025-02-01 18:54:58,703 - INFO - plz_einwohner.csv loaded successfully.
2025-02-01 18:54:58,703 - INFO - Starting preprop_resid function.
2025-02-01 18:54:58,704 - INFO - Renamed columns in DataFrame.
2025-02-01 18:54:58,711 - INFO - Formatted latitude and longitude columns.
2025-02-01 18:54:58,711 - INFO - Filtered DataFrame by postal codes. Remaining rows: 191
2025-02-01 18:54:58,713 - INFO - Starting sort_by_plz_add_geometry function.
2025-02-01 18:54:58,714 - INFO - Merged DataFrame with geometry. Shape: (191, 5)
2025-02-01 18:54:58,716 - INFO - DataFrame after dropping missing geometries. Shape: (190, 5)
2025-02-01 18:54:58,724 - INFO - sort_by_plz_add_geometry function completed successfully.
2025-02-01 18:54:58,724 - INFO - preprop_resid function completed successfully.
2025-02-01 18:54:58,724 - INFO -  ====> Duration 0.02 secs: 
Processes and prepares a dataframe by cleaning and filtering postal codes, renaming columns, and transforming
geographical data. The function works by copying the given data, transforming numeric columns into strings, and replacing
comma-separators for proper formatting. It also filters the dataset based on postal codes and combines additional
geometry information via another function.

Return: The processed dataframe with cleaned, formatted, and enriched data combining postal codes and geometrical information.
:rtype: pandas.DataFrame

2025-02-01 18:54:58,736 - INFO - Called create_electric_charging_residents_heatmap with args: (         PLZ  Number                                           geometry
0    10117.0      54  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
1    10119.0       6  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
2    10178.0      30  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
3    10179.0      37  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
4    10243.0      39  POLYGON ((13.42554 52.52371, 13.42862 52.52358...
..       ...     ...                                                ...
178  14169.0      17  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
179  14193.0       3  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
180  14195.0      32  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
181  14197.0      12  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
182  14199.0       7  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[183 rows x 3 columns],        PLZ  Einwohner Breitengrad Längengrad                                           geometry
0    10115      20313    52.53195    13.3838  POLYGON ((13.37239 52.53821, 13.3741 52.53717,...
1    10117      12217    52.51752   13.38777  POLYGON ((13.40031 52.5233, 13.40051 52.52216,...
2    10119      16363    52.53013   13.40551  POLYGON ((13.40056 52.53639, 13.4026 52.53507,...
3    10178      12167     52.5203   13.40473  POLYGON ((13.40918 52.52917, 13.41476 52.52779...
4    10179      18664    52.51379   13.41524  POLYGON ((13.42827 52.51895, 13.42751 52.51775...
..     ...        ...         ...        ...                                                ...
186  14169      17274       52.45   13.25883  POLYGON ((13.24957 52.45778, 13.25047 52.45803...
187  14193      15505    52.48135   13.23847  POLYGON ((13.28149 52.49817, 13.28228 52.49778...
188  14195      14667    52.45858   13.28463  POLYGON ((13.27759 52.47487, 13.28447 52.46998...
189  14197      17889    52.47319    13.3103  POLYGON ((13.32027 52.47775, 13.31991 52.47096...
190  14199      13657    52.47796   13.29242  POLYGON ((13.31186 52.48048, 13.30158 52.47452...

[190 rows x 5 columns],                                      Betreiber                  Straße Hausnummer Adresszusatz  Postleitzahl  ... P3 [kW] Public Key3       Steckertypen4 P4 [kW] Public Key4
0                        Albwerk GmbH & Co. KG          Ennabeurer Weg          0          NaN       72535.0  ...     NaN         NaN                 NaN     NaN         NaN
1                                        smopi               Albstraße         14          NaN       72535.0  ...      22         NaN  AC Steckdose Typ 2      22         NaN
2                        Albwerk GmbH & Co. KG  Parkplatz Campingplatz          0          NaN       72589.0  ...     NaN         NaN                 NaN     NaN         NaN
3                 EnBW mobility+ AG und Co.KG              Hauptstraße        91c          NaN       73340.0  ...     NaN         NaN                 NaN     NaN         NaN
4                             SWU Energie GmbH              Sterngasse          6          NaN       88481.0  ...     NaN         NaN                 NaN     NaN         NaN
...                                        ...                     ...        ...          ...           ...  ...     ...         ...                 ...     ...         ...
69381  Stadtwerke Weimar Stadtversorgungs-GmbH        Wunderwaldstraße         2a          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69382                                      eva               Lachenweg         13          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69383                          TEAG Mobil GmbH          Sulzaer Straße          0          NaN       99518.0  ...     NaN         NaN                 NaN     NaN         NaN
69384                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN
69385                                      NaN                     NaN        NaN          NaN           NaN  ...     NaN         NaN                 NaN     NaN         NaN

[69386 rows x 26 columns]), kwargs: {}
2025-02-01 18:54:58,737 - INFO - Starting merge_geo_dataframes function.
2025-02-01 18:54:58,740 - INFO - Merged population and charging stations DataFrames. Shape: (190, 6)
2025-02-01 18:54:58,743 - INFO - Filling NaN values in 'Number' column with 0.
2025-02-01 18:54:58,743 - INFO - merge_geo_dataframes function completed successfully.
2025-02-01 18:54:58,743 - INFO -  ====> Duration 0.01 secs: 
Merges the charging stations and population dataframes and fills NA's with 0
Inputs:
    - df_charging_stations: A geodataframe sorted by PLZ and containing information about the charging stations
    - df_population: A geodataframe sorted by PLZ and containing information about the population
Outputs: A merged geodataframe

2025-02-01 18:54:58,748 - INFO - Called ChargeStationRating with args: (), kwargs: {}
2025-02-01 18:54:58,748 - INFO - ChargeStationRating returned <src.application.chaging_station_rate.ChargeStationRating object at 0x00000207C4C10190>
2025-02-01 18:54:58,762 - INFO - create_electric_charging_residents_heatmap returned None
2025-02-01 18:54:58,771 - INFO -  ====> Duration 0.43 secs: Main: Generation of Streamlit App for visualizing electric charging stations & residents in Berlin 
